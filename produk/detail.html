<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Detail Produk</title>
</head>
<body>
  <div id="detail"></div>

  <script>
    const params = new URLSearchParams(window.location.search);
    const nama = params.get("nama");
    const data = JSON.parse(localStorage.getItem("produk")) || [];


    const produk = data.find(p => p.nama === nama);

    const el = document.getElementById("detail");

    if (produk) {
      const totalStok = produk.variasi ? produk.variasi.reduce((a, v) => a + (v.stok || 0), 0) : 0;
      const totalTerjual = produk.variasi ? produk.variasi.reduce((a, v) => a + (v.terjual || 0), 0) : 0;

      el.innerHTML = `
        <h1>${produk.nama}</h1>
        <img src="${produk.gambar || 'https://via.placeholder.com/300x160'}" width="300">
        <p><strong>Kategori:</strong> ${produk.kategori}</p>
        <p><strong>Harga:</strong> Rp ${produk.harga.toLocaleString('id-ID')}</p>
        <p><strong>Deskripsi:</strong> ${produk.deskripsi}</p>
        <p><strong>Stok Total:</strong> ${totalStok}</p>
        <p><strong>Total Terjual:</strong> ${totalTerjual}</p>
      `;
    } else {
      el.innerHTML = `<h2>Produk tidak ditemukan</h2>`;
    }
  </script>











<label for="variasi">Pilih Varian:</label>
<select id="variasi"></select>

<div>
  <button id="kurang">-</button>
  <span id="jumlah">1</span>
  <button id="tambah">+</button>
</div>
<button id="beli">Beli</button>


<script>
document.addEventListener("DOMContentLoaded", () => {
  const urlParams = new URLSearchParams(window.location.search);
  const namaProduk = urlParams.get("nama");

  const produkList = JSON.parse(localStorage.getItem("produk")) || [];
  const produkIndex = produkList.findIndex(p => p.nama === namaProduk);

  if (produkIndex === -1) {
    alert("Produk tidak ditemukan");
    return;
  }

  const produk = produkList[produkIndex];
  const variasiSelect = document.getElementById("variasi");
  const jumlahSpan = document.getElementById("jumlah");
  const tambahBtn = document.getElementById("tambah");
  const kurangBtn = document.getElementById("kurang");
  const beliBtn = document.getElementById("beli");

  // Tampilkan opsi variasi
  produk.variasi?.forEach((v, i) => {
    const opt = document.createElement("option");
    opt.value = i;
    opt.textContent = `${v.nama} (Stok: ${v.stok})`;
    variasiSelect.appendChild(opt);
  });

  let jumlah = 1;
  jumlahSpan.textContent = jumlah;

  tambahBtn.addEventListener("click", () => {
    jumlah++;
    jumlahSpan.textContent = jumlah;
  });

  kurangBtn.addEventListener("click", () => {
    if (jumlah > 1) {
      jumlah--;
      jumlahSpan.textContent = jumlah;
    }
  });

  beliBtn.addEventListener("click", () => {
    const indexVarian = parseInt(variasiSelect.value);
    const varian = produk.variasi[indexVarian];

    if (varian.stok >= jumlah) {
      varian.stok -= jumlah;
      varian.terjual = (varian.terjual || 0) + jumlah;

      // Simpan kembali
      produkList[produkIndex].variasi[indexVarian] = varian;
      localStorage.setItem("produk", JSON.stringify(produkList));

      alert(`Berhasil beli ${jumlah} ${produk.nama} - ${varian.nama}`);
      location.reload();
    } else {
      alert("Stok tidak mencukupi!");
    }
  });
});
</script>

</body>
</html>
